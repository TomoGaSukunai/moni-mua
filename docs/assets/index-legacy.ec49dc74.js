var __vite_style__=document.createElement("style");__vite_style__.innerHTML="*{padding:0;margin:0;box-sizing:border-box}body,html{min-height:100vh}html{background-color:#f9f9f9}#app{font-family:ST heiti,Avenir,Helvetica,Arial,sans-serif;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen,Ubuntu,Cantarell,'Open Sans','Helvetica Neue',sans-serif;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;color:#2c3e50;display:flex;min-height:100vh}li,ul{list-style:none}.flex{display:flex}.flex-1{flex:1}.align-center{align-items:center}.title{font-size:28px;text-align:center}.tips{font-size:12px;color:#999;margin-right:12px;margin-top:4px}.is-black{text-decoration:line-through;color:#ccc}.guard-face{display:inline-block;width:32px;height:32px;background-position:0 0;background-size:contain;background-repeat:no-repeat;border-radius:50%;margin-right:10px}.moni{position:relative;width:800px;height:600px;margin:auto;padding:20px;background-color:#fff;border-radius:4px;box-shadow:0 3px 4px 4px #eee;display:flex}.btn-black{position:absolute;top:10px;right:20px;font-weight:500;color:#999;cursor:pointer}.guard-title{height:30px;line-height:30px}.guard-list{width:300px;height:530px;border-right:1px solid #ccc;overflow-y:auto}.guard-item{display:flex;align-items:center;padding:3px 0;color:#999}.guard-item.alive{color:#000}.guard-item p span{color:#999}.no-scrollbar::-webkit-scrollbar,.no-scrollbar::-webkit-scrollbar-thumb{width:0;height:0;background-color:transparent}.filter{text-align:right;padding:5px 10px}.filter span{position:relative;padding-left:5px;font-size:14px;color:#666;cursor:pointer;user-select:none}.guard-item:hover .btn-to-black,.rank-list li:hover .btn-to-black{opacity:1}.btn-to-black{opacity:0;margin-right:5px;cursor:pointer;user-select:none;color:#666}.rank-list li .btn-to-black{margin-right:0;margin-left:5px}.btn-submit{padding:5px 10px;border:none;background-color:#10b981;color:#fff;border-radius:4px;outline:0;font-size:16px;cursor:pointer;margin-top:20px;margin-left:50px}.container{height:200px;align-items:center;justify-content:center}.container img{width:128px;height:128px}.container p{font-size:24px;font-weight:500}.btn-mua{width:80%;padding:6px 0;margin-left:10%;border:none;background-color:#10b981;color:#fff;border-radius:4px;outline:0;cursor:pointer;font-size:20px;transition:all .3s}.btn-mua:active{background-color:#059669}.rank-title{padding-top:20px;text-align:center}.rank-list{padding:20px 0 20px 20px;width:100%;height:210px;overflow-y:auto}.rank-list li{align-items:center;padding:3px 0;font-weight:500}.rank-list li p{flex:1;justify-content:space-between}.rank-list li p span{display:inline-block}.btn-clear{color:#60a5fa;font-size:14px;cursor:pointer}.mark{display:flex;position:absolute;top:0;left:0;width:100%;height:100%}.setting-container{position:relative;width:400px;height:180px;margin:auto;padding:10px 20px;background-color:#fff;border-radius:4px;box-shadow:0 3px 4px 4px rgba(0,0,0,.1)}.setting-container div{padding:5px 0;font-size:16px}.setting-container input{height:32px;padding:0 0 0 10px}.close{position:absolute;top:4px;right:10px;cursor:pointer}.black-list-container{position:relative;width:400px;height:400px;margin:auto;padding:10px 20px;background-color:#fff;border-radius:4px;box-shadow:0 3px 4px 4px rgba(0,0,0,.1)}.black-list{padding-top:20px;height:340px}.black-item{padding:4px 0}.black-item span{color:#999}",document.head.appendChild(__vite_style__),System.register(["./vendor-legacy.a04be182.js"],(function(){"use strict";var e,a,t,i,n,l,o,r,s,c,u,d,p,g,f,h,v,k,m,x;return{setters:[function(b){e=b.D,a=b.r,t=b.w,i=b.d,n=b.c,l=b.o,o=b.a,r=b.b,s=b.t,c=b.e,u=b.F,d=b.f,p=b.g,g=b.T,f=b.h,h=b.v,v=b.i,k=b.j,m=b.k,x=b.l}],execute:function(){const b=e.create({baseURL:"https://json2jsonp.com"});b.interceptors.response.use((e=>{const a=e.data;return JSON.parse(a.replace(/^_(?:_jsonp)?\((.*)\)$/,"$1"))}));function w(){const e=a([]),t=a(0),i=a(!1),n=a(!1);let l=1,o=[];async function r(a=!1){const{code:i,data:s}=await(async(e=1,a=!1)=>{const t=new Date,i="&"+t.getFullYear()+t.getMonth()+t.getDate()+t.getHours(),n=a?`&_=${Math.floor(Date.now()/1e3)}`:i;return await b.get("",{params:{url:`https://api.live.bilibili.com/guard/topList?roomid=23001181&page_size=29&ruid=1589117610&page=${e}${n}`,callback:"_"}})})(l,a);if(-412===i){const a=await(async()=>(await fetch("https://api.vtbs.moe/v1/guard/1589117610")).json())();return e.value=a.map((({mid:e,level:a,face:t,uname:i})=>({uid:e,face:t,username:i,guard_level:a,is_alive:0}))),n.value=!0,void alert("被拦截了，用缓存数据代替")}if(0!==i)return;n.value=!1;const{info:c,list:u}=s;if(o=1===l?u:[...o,...u],l===c.page)return o=[...s.top3,...o],e.value=[...o.filter((e=>1===e.is_alive)),...o.filter((e=>0===e.is_alive))],void(l=1);t.value=c.num,l++,await r(a)}return{isCache:n,loading:i,guardNum:t,guardList:e,onRefresh:async(a=!0,t=!1)=>{i.value||(t||(i.value=!0,e.value=[]),await r(a),i.value=!1)}}}const y=window.localStorage,S=window.sessionStorage,_={get(e){const a=y.getItem(e);return a?JSON.parse(a):""},set(e,a){y.setItem(e,JSON.stringify(a))},remove(e){y.removeItem(e)}},C={get(e){const a=S.getItem(e);return a?JSON.parse(a):""},set(e,a){S.setItem(e,JSON.stringify(a))},remove(e){S.removeItem(e)}},B="moni/rank/mua";const L={default:15,max:99,min:1,list:[{weight:8,area:[0,1]},{weight:6,area:[1,3]},{weight:4,area:[3,5]},{weight:2,area:[5,7]},{weight:1,area:[7,Number.MAX_SAFE_INTEGER]}]},N="moni/mua/weight",I="moni/mua/session/time";function G(e,i,n){const l=a({}),o=a(),r=a(!1),s={};let c={},u=0;(C.get(I)||Date.now())-Date.now()>72e5&&(C.remove(I),C.remove(N)),l.value=C.get(N)||{},t([e,i,l,n,r],(()=>{e.value.forEach((e=>{const a=i.value.find((a=>a.uid===e.uid));a&&(s[e.uid]=function(e){for(let a=0,t=L.list.length;a<t;a++){const{weight:t,area:i}=L.list[a],[n,l]=i;if(e>n&&e<=l)return t}return L.default}(a.count||0)),s[e.uid]=l.value[e.uid]||s[e.uid]||L.default})),c={};let a=0;e.value.forEach((e=>{if(n.value.includes(e.uid))return;if(r.value&&!e.is_alive)return;const t=s[e.uid];new Array(t).fill(0).forEach((()=>{c[a]=e,a++}))})),u=Object.keys(c).length-1}));return{weightList:l,currentGuard:o,filterNoLive:r,onRandomPick:()=>{const e=Math.floor(Math.random()*u);o.value=c[e]},setWeight:(e,a)=>{(a<L.min||a>L.max)&&(a=L.default),l.value[e]=a,C.set(N,{...l.value})},resetWeight:e=>{e?l.value[e]=L.default:l.value={},C.set(N,{...l.value})},weightConfig:L}}const M="moni/mua/blackList";var R=i({name:"App",setup(){const{loading:e,guardNum:t,guardList:i,onRefresh:o}=w(),{rankList:r,getRankList:s,addRank:c,onClearRank:u}=function(){const e=a([]);return{rankList:e,getRankList:()=>{e.value=(_.get(B)||[]).sort(((e,a)=>a.count-e.count))},addRank:a=>{if(!a)return;const t=e.value.findIndex((e=>e.uid===a.uid));-1===t?e.value.push({...a,count:1}):e.value[t].count=(e.value[t].count||0)+1,e.value=[...e.value.sort(((e,a)=>a.count-e.count))],_.set(B,e.value.map((({uid:e,username:a,face:t,count:i,is_alive:n})=>({uid:e,username:a,face:t,count:i,is_alive:n}))))},onClearRank:()=>{e.value=[],_.remove(B)}}}(),{blackList:d,addBlack:p,removeBlack:g,clearBlack:f,hasBlack:h,getBlackList:v}=function(){const e=a([]);e.value=_.get(M)||[];const t=a=>e.value.includes(a);return{blackList:e,hasBlack:t,addBlack:a=>{e.value.includes(a)||(e.value.push(a),_.set(M,e.value))},removeBlack:a=>{const t=e.value.indexOf(a);-1!==t&&(e.value.splice(t,1),_.set(M,e.value))},clearBlack:()=>{e.value=[],_.remove(M)},getBlackList:e=>e.value.filter((({uid:e})=>t(e)))}}(),{weightList:k,currentGuard:m,filterNoLive:x,setWeight:b,onRandomPick:y,weightConfig:S}=G(i,r,d),C=a(S.max),L=a(S.min),N=n((()=>v(i))),I=a(!1);async function R(){await o(!0,!0),m.value&&(m.value=i.value.find((e=>e.uid===m.value?.uid))||m.value),setTimeout((async()=>{await R()}),15e3)}l((async()=>{s(),await o(!1),await R()}));const W=a(!1);let z;const E=a(!1),j=a(),O=a(S.default),T=()=>{E.value=!E.value};return{loading:e,guardNum:t,guardList:i,filterNoLive:x,currentGuard:m,onMua:()=>{e.value||(W.value?(W.value=!1,z&&clearInterval(z),c(m.value)):(W.value=!0,y(),z=setInterval((()=>y()),15)))},rankList:r,onClearRank:u,active:W,weightList:k,WEIGHT_MAX:C,WEIGHT_MIN:L,computedBlackList:N,hasBlack:h,blackList:d,addBlack:p,removeBlack:g,clearBlack:f,showBlack:I,onShowBlack:()=>{I.value=!I.value},showSetting:E,selectGuard:j,selectWeight:O,onSelect:e=>{j.value=e,O.value=k.value[e.uid]||S.default,T()},onShowSetting:T,onWeightInput:()=>{O.value<S.min?O.value=S.min:O.value>S.max&&(O.value=S.max)},onSubmitWeight:()=>{j.value&&b(j.value.uid,O.value),T()}}}});const W={class:"moni"},z={class:"guard-container"},E={class:"flex"},j={class:"guard-title flex-1"},O=r("p",{class:"tips"},"每15秒刷新",-1),T={class:"guard-list no-scrollbar"},A={key:0},H={class:"flex-1"},D=r("h3",{class:"title"},"朝海沫霓Moni Mua~",-1),J={class:"container flex"},$={key:0,style:{padding:"0 20px",color:"#999"}},F={key:1},U={class:"filter"},X={class:"rank-title flex align-center"},P=r("p",{class:"flex-1"},"刀了榜",-1),V={class:"rank-list no-scrollbar"},Y={class:"flex"},q={class:"setting-container"},K=r("h4",null,"权重设置",-1),Q={class:"flex align-center"},Z=r("span",null,"舰长：",-1),ee={key:0,class:"flex-1"},ae={class:"flex align-center"},te=r("span",null,"权重：",-1),ie={class:"black-list-container"},ne=r("h4",null,"黑名单",-1),le={class:"black-list no-scrollbar"},oe={class:"flex-1"};R.render=function(e,a,t,i,n,l){return m(),o(u,null,[r("div",W,[r("div",z,[r("div",E,[r("h3",j," 舰长总数： "+s(e.guardNum),1),O]),r("ul",T,[e.loading?(m(),o("li",A," 获取舰长数据中... ")):c("",!0),(m(!0),o(u,null,d(e.guardList,(a=>f((m(),o("li",{key:a.uid,class:["guard-item",a.is_alive?"alive":""]},[r("img",{class:"guard-face",src:a.face+"@128w_128h",alt:"",onClick:t=>e.onSelect(a)},null,8,["src","onClick"]),r("p",{class:["flex-1",{"is-black":e.hasBlack(a.uid)}],onClick:t=>e.onSelect(a)},[r("span",null,s(a.is_alive?"[在线]":""),1),p(" "+s(a.username),1)],10,["onClick"]),r("span",{class:"btn-to-black",onClick:t=>e.addBlack(a.uid)},"[黑]",8,["onClick"])],2)),[[h,!e.filterNoLive||a.is_alive]]))),128))])]),r("div",H,[r("span",{class:"btn-black",onClick:a[1]||(a[1]=(...a)=>e.onShowBlack&&e.onShowBlack(...a))},"黑名单"),D,r("div",J,[e.currentGuard?c("",!0):(m(),o("p",$," 点击按钮开始抽取，再次点击停止，最终显示的则为今晚的幸运儿。 ")),e.currentGuard?(m(),o(u,{key:1},[e.currentGuard.face?(m(),o("img",{key:0,class:"guard-face",src:e.currentGuard.face+"@128w_128h",alt:""},null,8,["src"])):c("",!0),e.currentGuard&&e.currentGuard.uid?(m(),o("p",F,[r("span",null,s(e.currentGuard.is_alive?"[在线]":"[不在]"),1),p(" "+s(e.currentGuard.username),1)])):c("",!0)],64)):c("",!0)]),r("div",null,[r("p",U,[r("input",{type:"checkbox",checked:e.filterNoLive,onClick:a[2]||(a[2]=a=>e.filterNoLive=!e.filterNoLive)},null,8,["checked"]),r("span",{onClick:a[3]||(a[3]=a=>e.filterNoLive=!e.filterNoLive)}," 过滤不在线舰长 ")]),r("button",{class:"btn-mua",onClick:a[4]||(a[4]=(...a)=>e.onMua&&e.onMua(...a))},s(e.active?"就Mua你了！":"Mua谁呢？"),1)]),r("h3",X,[P,r("span",{class:"btn-clear",onClick:a[5]||(a[5]=(...a)=>e.onClearRank&&e.onClearRank(...a))},"清空")]),r("ul",V,[(m(!0),o(u,null,d(e.rankList,(a=>(m(),o("li",{key:a.uid,class:"flex"},[r("img",{class:"guard-face",src:a.face+"@128w_128h",alt:"",onClick:t=>e.onSelect(a)},null,8,["src","onClick"]),r("p",Y,[r("span",{class:["flex-1",{"is-black":e.hasBlack(a.uid)}],onClick:t=>e.onSelect(a)},s(a.username),11,["onClick"]),r("span",null,s(a.count)+" 次",1)]),r("span",{class:"btn-to-black",onClick:t=>e.addBlack(a.uid)},"[黑]",8,["onClick"])])))),128))])])]),(m(),o(g,{to:"body"},[f(r("div",{class:"mark",onClick:a[10]||(a[10]=k(((...a)=>e.onShowSetting&&e.onShowSetting(...a)),["self"]))},[r("div",q,[r("span",{class:"close",onClick:a[6]||(a[6]=(...a)=>e.onShowSetting&&e.onShowSetting(...a))},"x"),K,r("div",Q,[Z,e.selectGuard?(m(),o("span",ee,s(e.selectGuard.username),1)):c("",!0)]),r("div",ae,[te,f(r("input",{class:"flex-1",type:"number",min:e.WEIGHT_MIN,max:e.WEIGHT_MAX,placeholder:"15","onUpdate:modelValue":a[7]||(a[7]=a=>e.selectWeight=a),onInput:a[8]||(a[8]=(...a)=>e.onWeightInput&&e.onWeightInput(...a))},null,40,["min","max"]),[[v,e.selectWeight]])]),r("div",null,[r("button",{class:"btn-submit",onClick:a[9]||(a[9]=(...a)=>e.onSubmitWeight&&e.onSubmitWeight(...a))},"确认")])])],512),[[h,e.showSetting]])])),(m(),o(g,{to:"body"},[f(r("div",{class:"mark",onClick:a[13]||(a[13]=k(((...a)=>e.onShowBlack&&e.onShowBlack(...a)),["self"]))},[r("div",ie,[r("span",{class:"close",onClick:a[11]||(a[11]=(...a)=>e.onShowBlack&&e.onShowBlack(...a))},"x"),ne,r("span",{class:"btn-clear",onClick:a[12]||(a[12]=(...a)=>e.clearBlack&&e.clearBlack(...a))},"清空"),r("ul",le,[(m(!0),o(u,null,d(e.computedBlackList,(a=>(m(),o("li",{key:a.uid,class:"black-item flex align-center"},[r("p",oe,s(a.username),1),r("span",{onClick:t=>e.removeBlack(a.uid)},"删除",8,["onClick"])])))),128))])])],512),[[h,e.showBlack]])]))],64)},x(R).mount("#app")}}}));
