var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,u=(a,t,r)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r;import{D as l,r as c,d as o,o as i,c as d,a as p,t as m,b as v,F as f,e as g,f as b,g as y,h}from"./vendor.cc48ec22.js";!function(e=".",a="__import__"){try{self[a]=new Function("u","return import(u)")}catch(t){const r=new URL(e,location),n=e=>{URL.revokeObjectURL(e.src),e.remove()};self[a]=e=>new Promise(((t,s)=>{const u=new URL(e,r);if(self[a].moduleMap[u])return t(self[a].moduleMap[u]);const l=new Blob([`import * as m from '${u}';`,`${a}.moduleMap['${u}']=m;`],{type:"text/javascript"}),c=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(l),onerror(){s(new Error(`Failed to import: ${e}`)),n(c)},onload(){t(self[a].moduleMap[u]),n(c)}});document.head.appendChild(c)})),self[a].moduleMap={}}}("/assets/");const w=l.create({baseURL:"https://json2jsonp.com"});w.interceptors.response.use((e=>{const a=e.data;return JSON.parse(a.replace(/^_(?:_jsonp)?\((.*)\)$/,"$1"))}));function _(){const e=c([]),a=c(0);let t=1,r=[];return{guardNum:a,guardList:e,getGuardList:async function n(s=!1){const{code:u,data:l}=await(async(e=1,a=!1)=>{const t=a?`&t=${Date.now()}`:"";return await w.get("",{params:{url:`https://api.live.bilibili.com/guard/topList?roomid=23001181&page_size=29&ruid=1589117610&page=${e}${t}`,callback:"_"}})})(t,s);if(0!==u)return;const{info:c,list:o}=l;if(r=1===t?o:[...r,...o],t===c.page)return r=[...l.top3,...r],e.value=[...r.filter((e=>1===e.is_alive)),...r.filter((e=>0===e.is_alive))],void(t=1);a.value=c.num,t++,await n(s)},getRandomGuard:function(){const a=Math.floor(Math.random()*(e.value.length-1));return e.value[a]}}}const k=window.localStorage,L={get(e){try{const a=k.getItem(e);return a?JSON.parse(a):""}catch{return""}},set(e,a){k.setItem(e,JSON.stringify(a))}};var O=o({name:"App",setup(){const{guardNum:e,guardList:l,getGuardList:o,getRandomGuard:d}=_(),p=c(!1),m=async(e=!0)=>{p.value||(p.value=!0,l.value=[],await o(e),p.value=!1)};i((async()=>{await m(!1)}));const v=c({}),f=c(!1),g=c([]);let b;g.value=(L.get("moni/rank/mua")||[]).sort(((e,a)=>a.count-e.count));return{loading:p,guardNum:e,guardList:l,onRefresh:m,currentGuard:v,onMua:()=>{var e;if(!p.value)if(f.value){f.value=!1,b&&clearInterval(b);const l=g.value.findIndex((e=>e.uid===v.value.uid));-1===l?g.value.push((e=((e,a)=>{for(var t in a||(a={}))n.call(a,t)&&u(e,t,a[t]);if(r)for(var t of r(a))s.call(a,t)&&u(e,t,a[t]);return e})({},v.value),a(e,t({count:1})))):g.value[l].count=g.value[l].count+1,g.value=g.value.sort(((e,a)=>a.count-e.count)),L.set("moni/rank/mua",g.value.map((({uid:e,username:a,face:t,count:r,is_alive:n})=>({uid:e,username:a,face:t,count:r,is_alive:n}))))}else f.value=!0,v.value=d(),b=setInterval((()=>{v.value=d()}),10)},rankList:g,active:f}}});const j={class:"moni"},M={class:"guard-container"},G={class:"flex"},R={class:"guard-title flex-1"},x={class:"guard-list no-scrollbar"},$={key:0},N={class:"flex-1"},U=p("h3",{class:"title"},"朝海沫霓Moni Mua~",-1),I={class:"container flex"},P={key:0,style:{padding:"0 20px",color:"#999"}},S={key:2},C=p("h3",{class:"rank-title"},"刀了榜",-1),D={class:"rank-list no-scrollbar"},E={class:"flex"},F={class:"flex-1"};O.render=function(e,a,t,r,n,s){return y(),d("div",j,[p("div",M,[p("div",G,[p("h3",R," 舰长总数： "+m(e.guardNum),1),p("button",{class:"btn-reload",onClick:a[1]||(a[1]=(...a)=>e.onRefresh&&e.onRefresh(...a))},"刷新")]),p("ul",x,[e.loading?(y(),d("li",$," 获取舰长数据中... ")):v("",!0),(y(!0),d(f,null,g(e.guardList,(e=>(y(),d("li",{key:e.uid,class:["guard-item",e.is_alive?"alive":""]},[p("img",{class:"guard-face",src:e.face+"@128w_128h",alt:""},null,8,["src"]),p("p",null,[p("span",null,m(e.is_alive?"[在线]":""),1),b(" "+m(e.username),1)])],2)))),128))])]),p("div",N,[U,p("div",I,[e.currentGuard&&e.currentGuard.uid?v("",!0):(y(),d("p",P," 点击按钮开始抽取，再次点击停止，最终显示的则为今晚的幸运儿。 ")),e.currentGuard.face?(y(),d("img",{key:1,class:"guard-face",src:e.currentGuard.face+"@128w_128h",alt:""},null,8,["src"])):v("",!0),e.currentGuard&&e.currentGuard.uid?(y(),d("p",S,[p("span",null,m(e.currentGuard.is_alive?"[在线]":"[不在]"),1),b(" "+m(e.currentGuard.username),1)])):v("",!0)]),p("div",null,[p("button",{class:"btn-mua",onClick:a[2]||(a[2]=(...a)=>e.onMua&&e.onMua(...a))},m(e.active?"就Mua你了！":"Mua谁呢？"),1)]),C,p("ul",D,[(y(!0),d(f,null,g(e.rankList,(e=>(y(),d("li",{key:e.uid,class:"flex"},[p("img",{class:"guard-face",src:e.face+"@128w_128h",alt:""},null,8,["src"]),p("p",E,[p("span",F,m(e.username),1),p("span",null,m(e.count)+" 次",1)])])))),128))])])])},h(O).mount("#app");
