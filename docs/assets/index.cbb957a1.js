var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,l=(a,t,r)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r;import{D as u,r as c,d as o,o as i,c as d,a as p,t as m,b as v,F as f,e as g,f as b,g as y,h}from"./vendor.cc48ec22.js";!function(e=".",a="__import__"){try{self[a]=new Function("u","return import(u)")}catch(t){const r=new URL(e,location),s=e=>{URL.revokeObjectURL(e.src),e.remove()};self[a]=e=>new Promise(((t,n)=>{const l=new URL(e,r);if(self[a].moduleMap[l])return t(self[a].moduleMap[l]);const u=new Blob([`import * as m from '${l}';`,`${a}.moduleMap['${l}']=m;`],{type:"text/javascript"}),c=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(u),onerror(){n(new Error(`Failed to import: ${e}`)),s(c)},onload(){t(self[a].moduleMap[l]),s(c)}});document.head.appendChild(c)})),self[a].moduleMap={}}}("/assets/");const w=u.create({baseURL:"https://json2jsonp.com"});w.interceptors.response.use((e=>{const a=e.data;return JSON.parse(a.replace(/^_(?:_jsonp)?\((.*)\)$/,"$1"))}));function _(){const e=c([]),a=c(0);let t=1,r=[];return{guardNum:a,guardList:e,getGuardList:async function s(n=!1){const{code:l,data:u}=await(async(e=1,a=!1)=>{const t=a?`&t=${Date.now()}`:"";return await w.get("",{params:{url:`https://api.live.bilibili.com/guard/topList?roomid=23001181&ruid=1589117610&page=${e}${t}`,callback:"_"}})})(t,n);if(0!==l)return;const{info:c,list:o}=u;if(t===c.page)return e.value=[...r.filter((e=>1===e.is_alive)),...r.filter((e=>0===e.is_alive))],void(t=1);r=[...r,...o],a.value=c.num,t++,await s(n)},getRandomGuard:function(){const a=Math.floor(Math.random()*(e.value.length-1));return e.value[a]}}}const L=window.localStorage,k={get(e){try{const a=L.getItem(e);return a?JSON.parse(a):""}catch{return""}},set(e,a){L.setItem(e,JSON.stringify(a))}};var O=o({name:"App",setup(){const{guardNum:e,guardList:u,getGuardList:o,getRandomGuard:d}=_(),p=c(!1),m=async(e=!0)=>{p.value||(p.value=!0,u.value=[],await o(e),p.value=!1)};i((async()=>{await m(!1)}));const v=c({}),f=c(!1),g=c([]);let b;g.value=k.get("moni/rank/mua")||[];return{loading:p,guardNum:e,guardList:u,onRefresh:m,currentGuard:v,onMua:()=>{var e;if(!p.value)if(f.value){f.value=!1,b&&clearInterval(b);const u=g.value.findIndex((e=>e.uid===v.value.uid));-1===u?g.value.push((e=((e,a)=>{for(var t in a||(a={}))s.call(a,t)&&l(e,t,a[t]);if(r)for(var t of r(a))n.call(a,t)&&l(e,t,a[t]);return e})({},v.value),a(e,t({count:1})))):g.value[u].count=g.value[u].count+1,g.value=g.value.sort(((e,a)=>e.count-a.count)),k.set("moni/rank/mua",g.value.map((({uid:e,username:a,face:t,count:r,is_alive:s})=>({uid:e,username:a,face:t,count:r,is_alive:s}))))}else f.value=!0,v.value=d(),b=setInterval((()=>{v.value=d()}),10)},rankList:g}}});const j={class:"moni"},M={class:"guard-container"},R={class:"flex"},G={class:"guard-title flex-1"},x={class:"guard-list no-scrollbar"},$={key:0},N={class:"flex-1"},U=p("h3",{class:"title"},"朝海沫霓Moni Mua~",-1),I={class:"container flex"},P={key:1},S=p("h3",{class:"rank-title"},"刀了榜",-1),C={class:"rank-list no-scrollbar"},D={class:"flex"},E={class:"flex-1"};O.render=function(e,a,t,r,s,n){return y(),d("div",j,[p("div",M,[p("div",R,[p("h3",G," 舰长总数： "+m(e.guardNum),1),p("button",{class:"btn-reload",onClick:a[1]||(a[1]=(...a)=>e.onRefresh&&e.onRefresh(...a))},"刷新")]),p("ul",x,[e.loading?(y(),d("li",$," 获取舰长数据中... ")):v("",!0),(y(!0),d(f,null,g(e.guardList,(e=>(y(),d("li",{key:e.uid,class:["guard-item",e.is_alive?"alive":""]},[p("img",{class:"guard-face",src:e.face+"@128w_128h",alt:""},null,8,["src"]),p("p",null,[p("span",null,m(e.is_alive?"[在线]":""),1),b(" "+m(e.username),1)])],2)))),128))])]),p("div",N,[U,p("div",I,[e.currentGuard.face?(y(),d("img",{key:0,class:"guard-face",src:e.currentGuard.face+"@128w_128h",alt:""},null,8,["src"])):v("",!0),e.currentGuard&&e.currentGuard.uid?(y(),d("p",P,[p("span",null,m(e.currentGuard.is_alive?"[在线]":"[不在]"),1),b(" "+m(e.currentGuard.username),1)])):v("",!0)]),p("div",null,[p("button",{class:"btn-mua",onClick:a[2]||(a[2]=(...a)=>e.onMua&&e.onMua(...a))},m(e.active?"Mua谁呢？":"就Mua你了！"),1)]),S,p("ul",C,[(y(!0),d(f,null,g(e.rankList,(e=>(y(),d("li",{key:e.uid,class:"flex"},[p("img",{class:"guard-face",src:e.face+"@128w_128h",alt:""},null,8,["src"]),p("p",D,[p("span",E,m(e.username),1),p("span",null,m(e.count)+" 次",1)])])))),128))])])])},h(O).mount("#app");
